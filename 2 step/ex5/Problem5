E. Ноды и диагностика
Полное решение
Ограничение времени	1 секунда
Ограничение памяти	64 Мб
Ввод	стандартный ввод или input.txt
Вывод	стандартный вывод или output.txt
Зaдaниe нa знaниe SQL.

Артемий занимается регламентными работами на кластере, ему дали данные о последних проведенных работах в виде таблицы nodebase, вот несколько строк:

node    parent  diagnostics
7       5       2025-07-01
5               2023-06-08
1               2025-06-10
10      7       2024-12-08
11      7       2024-02-18
14      7       2022-06-04
3       11      2025-07-24
2       11      2025-03-26
4       3       2024-11-11
6       3       2025-04-19
8       3       2023-02-17
8       3       2024-12-31


где node - id ноды, parent - id родительской ноды, diagnostics - дата диагностики ноды (если нода диагностировалась несколько раз за последние 5 лет, в таблице будет несколько строк с одинаковыми node).

Помогите Артемию подготовить отчет, в котором необходимо вывести номер ноды, ее положение в иерархии (начальная - root, внутренняя - inner или конечная - leaf) и время ее последней диагностики Важно сначала вывести начальные ноды, у которых прошло наибольшее время с дня последней диагностики, затем ноды inner и в конце leaf. Необходимо написать запрос на sqlite, который поможет собрать нужную информацию в правильной сортировке.

Ответ
Язык
SQLite 3.50.4